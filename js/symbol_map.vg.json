{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "width": 600,
  "height": 450,
  "title": "Number of at Risk Species by Region",
  "projection": {"type": "equirectangular"},
  "layer": [
    {
      "data": {
        "url": "https://raw.githubusercontent.com/rcra0006/homeworkweek9/refs/heads/main/data/ne_110m.json",
        "format": {"type": "topojson", "feature": "ne_110m_admin_0_countries"}
      },
      "mark": {"type": "geoshape", "fill": "lightgray", "stroke": "white"}
    },
    {
      "data": {
        "url": "https://raw.githubusercontent.com/rcra0006/homeworkweek9/refs/heads/main/data/speciesdata.csv"
      },
      "params": [
        {
          "name": "map_class",
          "value": [{"Class": "Aves"}],
          "select": {"type": "point", "fields": ["Class"]},
          "bind": {
            "Class": {
              "input": "radio",
              "labels": [
                "All",
                "Aves",
                "Mammalia",
                "Liliopsida",
                "Magnoliopsida"
              ],
              "options": [
                null,
                "Aves",
                "Mammalia",
                "Liliopsida",
                "Magnoliopsida"
              ],
              "name": "Class: "
            }
          }
        }
      ],
      "transform": [
        {"filter": "datum.IUCNStatus != ''"},
        {"filter": "datum.State != 'Commonwealth'"},
        {"filter": "datum.RegionCentroidLatitude >= -50"},
        {"filter": "datum.RegionCentroidLongitude <= 155"},
        {"filter": {"param": "map_class"}}
      ],
      "mark": {"type": "circle"},
      "encoding": {
        "longitude": {
          "field": "RegionCentroidLongitude",
          "type": "quantitative"
        },
        "latitude": {"field": "RegionCentroidLatitude", "type": "quantitative"},
        "size": {"value": 40},
        "color": {
          "field": "Species",
          "aggregate": "count",
          "type": "quantitative",
          "title": "Status",
          "scale": {"scheme": "greens"}
        },
        "tooltip": [
          {"title": "Region: ", "field": "Region", "type": "nominal"},
          {
            "title": "Number of at risk species: ",
            "field": "__count",
            "type": "quantitative"
          }
        ]
      }
    },
    {
      "data": {
        "url": "https://raw.githubusercontent.com/rcra0006/homeworkweek9/refs/heads/main/data/speciesdata.csv"
      },
      "mark": "rule",
      "encoding": {
        "x": {"value": 506},
        "x2": {"value": 535},
        "y": {"value": 335},
        "y2": {"value": 400}
      }
    },
    {
      "data": {
        "url": "https://raw.githubusercontent.com/rcra0006/homeworkweek9/refs/heads/main/data/speciesdata.csv"
      },
      "mark": "text",
      "encoding": {
        "text": {"value": "Inland Slopes"},
        "x": {"value": 568},
        "y": {"value": 400}
      }
    },
    {
      "data": {
        "url": "https://raw.githubusercontent.com/rcra0006/homeworkweek9/refs/heads/main/data/speciesdata.csv"
      },
      "mark": "rule",
      "encoding": {
        "x": {"value": 93},
        "x2": {"value": 120},
        "y": {"value": 303},
        "y2": {"value": 375}
      }
    },
    {
      "data": {
        "url": "https://raw.githubusercontent.com/rcra0006/homeworkweek9/refs/heads/main/data/speciesdata.csv"
      },
      "mark": "text",
      "encoding": {
        "text": {"value": "Perth"},
        "x": {"value": 120},
        "y": {"value": 385}
      }
    }
  ]
}